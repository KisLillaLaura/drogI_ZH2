<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N√∂v√©nyismereti J√°t√©k</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        .menu, .submenu {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 18px;
            margin: 10px;
            cursor: pointer;
        }
        .submenu {
            display: none;
        }
        #sketchem-container {
            display: none;
        }
	#kepfelismeres-container {
    	    display: none;
	}
	#szamolas-container, #tabla-container {
    	    display: none;
	}
	/* Ideiglenes elrejt√©s */
	#szamolasSubMenu, 
	#szamolas-container,
	#tabla-container, 
	#tablaSubMenu,
	#fitokemia_altalanos-container,
	#fitokemia-container,
	#fitoanalitika-container {
    	display: none !important;
	}
	/* T√°bl√°zatos j√°t√©kok st√≠lusa */
	#tabla-container, 
	#fitokemia_altalanos-container,
	#fitokemia-container,
	#fitoanalitika-container {
   	 max-width: 900px;
   	 margin: 0 auto;
	}

	table {
  	  width: 100%;
 	   margin: 20px 0;
 	   border-collapse: collapse;
	}

	th, td {
 	   padding: 12px;
 	   text-align: left;
 	   border: 1px solid #ddd;
	}

	th {
  	  background-color: #f8f9fa;
  	  font-weight: bold;
	}

	select {
    	width: 100%;
    	padding: 8px;
   	 border-radius: 4px;
   	 border: 1px solid #ccc;
	}
    </style>
</head>
<body>
    <h1>√údv√∂z√∂llek a N√∂v√©nyismereti J√°t√©kban!</h1>
    <p>V√°lassz egy feladatt√≠pust:</p>
    
    <div class="menu" id="mainMenu">
        <button onclick="showSubMenu('novenyfelismeres')">N√∂v√©nyfelismer√©s</button>
        <button onclick="showSubMenu('kepletek')">K√©pletek</button>
	
    </div>

    <!-- Almen√ºk -->

    <div class="submenu" id="novenyfelismeresSubMenu">
        <h2>N√∂v√©nyfelismer√©s</h2>
        <button onclick="startMakroszkopikusJatek()">Makroszk√≥pikus felismer√©s</button>
        <button onclick="startMikroszkopikusJatek()">Mikroszk√≥pikus felismer√©s</button>
        <button onclick="goBack()">üîô Vissza</button>
    </div>
	
    <div class="submenu" id="kepletekSubMenu">
        <h2>K√©pletek</h2>
        <button onclick="startFormulaRecognition()">K√©plet felismer√©s</button>
        <button onclick="startFormulaDrawing()">K√©plet rajzol√°s</button>
        <button onclick="goBack()">üîô Vissza</button>
    </div>
    <!-- Sz√°mol√°si feladatok almen√º -->
    <div class="submenu" id="szamolasSubMenu">
        <h2>Sz√°mol√°si feladatok</h2>
        <button onclick="startSzamolas('el_nem_szappanosithato')">El nem szappanos√≠that√≥ r√©sz tartalmi meghat√°roz√°sa</button>
        <button onclick="startSzamolas('aszkorbinsav')">Aszkorbinsav tartalmi meghat√°roz√°sa</button>
        <button onclick="goBack()">üîô Vissza</button>
    </div>

<!-- T√°bl√°zatkit√∂lt√©s almen√º -->
    <div class="submenu" id="tablaSubMenu">
        <h2>T√°bl√°zatkit√∂lt√©s</h2>
        <button onclick="startTabla('fitokemia')">Drogok fitok√©mi√°ja</button>
        <button onclick="startTabla('fitoanalitika')">√Åltal√°nos fitoanalitika</button>
        <button onclick="startTabla('fitokemia_altalanos')">√Åltal√°nos fitok√©mia</button>
        <button onclick="goBack()">üîô Vissza</button>
    </div>

    <div id="sketchem-container">
        <h2>Rajzold le az al√°bbi molekul√°t:</h2>
        <h3 id="molekula-name"></h3>
        <p><button onclick="openSketChem()">üñå SketChem megnyit√°sa</button></p>
        <p>Miut√°n elk√©sz√ºlt√©l, export√°ld a SMILES k√≥dot (fels≈ë ikonok, lefele nyilas t√©glalap; .smi .smiles form√°tum), √©s m√°sold be ide:</p>
        <input type="text" id="smiles-input" placeholder="Illeszd be a SMILES k√≥dot">
        <br>
        <p>V√°laszd ki a csoportot:</p>
        <select id="csoport-select">
            <option value="Sz√©nhidr√°tok">Sz√©nhidr√°tok</option>
            <option value="Lipidek">Lipidek</option>
            <option value="N√∂v√©nyi savak">N√∂v√©nyi savak</option>
        </select>
        <br>
        <button onclick="exportSMILES()">‚úÖ Ellen≈ërz√©s</button>
        <button onclick="goBack()">üîô Vissza</button>
        <p id="smiles-output"></p>
        <button onclick="newMolecule()">√öj molekula</button>
        <button onclick="retry()">√öjrapr√≥b√°l√°s</button>
    </div>

    <div id="kepfelismeres-container">
    	<h2>Mi a k√©pen l√°that√≥ molekula neve?</h2>
    	<img id="molekula-kep" src="" alt="Molekula k√©pe" style="max-width: 300px; margin: 20px auto; display: block;">
    	<input type="text" id="name-input" placeholder="√çrd be a molekula nev√©t">
    	<br><br>
    	<button onclick="checkName()">‚úÖ Ellen≈ërz√©s</button>
    	<button onclick="goBack()">üîô Vissza</button>
    	<p id="name-output"></p>
    	<button onclick="newMoleculeRecognition()">√öj molekula</button>
    	<button onclick="retryRecognition()">√öjrapr√≥b√°l√°s</button>
    </div>
	
    <div id="makroszkopikus-container" class="submenu">
    	<h2>Makroszk√≥pikus n√∂v√©nyfelismer√©s</h2>
    	<img id="noveny-kep" src="" alt="N√∂v√©ny k√©pe" style="max-width: 400px; margin: 20px auto; display: block;">
    	<div class="input-group">
        	<label>Drog magyar neve:</label>
        	<input type="text" id="magyar-drog">
    	</div>
  	<div class="input-group">
        	<label>Drog latin neve:</label>
        	<input type="text" id="latin-drog">
	</div>
    	<div class="input-group">
        	<label>N√∂v√©ny latin neve:</label>
        	<input type="text" id="latin-noveny">
    	</div>
    	<div class="input-group">
        	<label>N√∂v√©ny csal√°dja latinul:</label>
        	<input type="text" id="csalad-noveny">
    	</div>
    	<button onclick="checkNoveny()">‚úÖ Ellen≈ërz√©s</button>
    	<button onclick="goBack()">üîô Vissza</button>
    	<p id="noveny-eredmeny"></p>
    	<button onclick="ujNoveny()">√öj n√∂v√©ny</button>
    </div>
    <!-- Mikroszk√≥pikus felismer√©s kont√©ner -->
    
    <div id="mikroszkopikus-container" class="submenu">
    	<h2>Mikroszk√≥pikus felismer√©s</h2>
    	<div id="mikro-kepek"></div>
    	<div id="mikro-valaszok">
            <div id="mikro-feature-dropdowns"></div>
            <div class="input-group">
                <label>Melyik drog sz√∂vetei l√°that√≥k?</label>
            	<select id="mikro-drog-select"></select>
            </div>
    	</div>
    	<button onclick="checkMikro()">‚úÖ Ellen≈ërz√©s</button>
    	<button onclick="goBack()">üîô Vissza</button>
    	<p id="mikro-eredmeny"></p>
    	<button onclick="ujMikroJatek()">√öj j√°t√©k</button>
    </div>

	<!-- Sz√°mol√°si feladatok kont√©ner -->
    <div id="szamolas-container" class="submenu">
        <h2 id="szamolas-cim"></h2>
        <!-- Ide j√∂nnek a sz√°mol√°si feladatok -->
        <button onclick="goBack()">üîô Vissza</button>
    </div>

    <!-- T√°bl√°zatkit√∂lt√©s kont√©ner -->
    <div id="tabla-container" class="submenu">
        <h2 id="tabla-cim"></h2>
        <!-- Ide j√∂nnek a t√°bl√°zatok -->
        <button onclick="goBack()">üîô Vissza</button>
    </div>
	<!-- T√°bl√°zatkit√∂lt√©s kont√©nerek -->

    <!-- √Åltal√°nos fitok√©mia kont√©ner -->
    <div id="fitokemia_altalanos-container" class="submenu">
        <h2>√Åltal√°nos fitok√©mia</h2>
        <div id="fitokemia_altalanos-content"></div>
        <button onclick="checkTabla('altalanos')">‚úÖ Ellen≈ërz√©s</button>
        <button onclick="goBack()">üîô Vissza</button>
        <p id="fitokemia_altalanos-eredmeny"></p>
    </div>

<!-- Drogok fitok√©mi√°ja kont√©ner -->
    <div id="fitokemia-container" class="submenu">
        <h2>Drogok fitok√©mi√°ja</h2>
        <div id="fitokemia-content"></div>
        <button onclick="checkTabla('drogok')">‚úÖ Ellen≈ërz√©s</button>
        <button onclick="goBack()">üîô Vissza</button>
        <p id="fitokemia-eredmeny"></p>
    </div>

<!-- √Åltal√°nos fitoanalitika kont√©ner -->
    <div id="fitoanalitika-container" class="submenu">
        <h2>√Åltal√°nos fitoanalitika</h2>
        <div id="fitoanalitika-content"></div>
        <button onclick="checkTabla('analitika')">‚úÖ Ellen≈ërz√©s</button>
        <button onclick="goBack()">üîô Vissza</button>
        <p id="fitoanalitika-eredmeny"></p>
    </div>
	

    <script>
	const fitokemiaTablazat = [
    	    {
                azonositas: "kem√©ny√≠t≈ë",
                reakcio: "komplexk√©pz√©s",
                reagens: "lugol-oldat",
                eszleles: "s√∂t√©tk√©k/fekete elsz√≠nez≈ëd√©s"
    	    },
            {
                azonositas: "inulin vagy hidroxi-metil-furfural",
                reakcio: "Seliwanoff",
                reagens: "HCl, rezorcin, h≈ë",
                eszleles: "piros"
            },
            {
                azonositas: "arabinoxil√°n",
                reakcio: "Bial",
                reagens: "HCl + orcinol + FeCl3 + h≈ë",
                eszleles: "t√ºrkiz"
            },
            {
                azonositas: "A-vitamin",
                reakcio: "Carr-Price",
                reagens: "kloroform, SbCl3 krist√°ly",
                eszleles: "k√©k"
            },
            {
                azonositas: "avass√°g (epihidrin-aldehid)",
                reakcio: "gy≈±r≈± felny√≠l√°s",
                reagens: "HCl, floroglucin",
                eszleles: "v√∂r√∂s"
            },
            {
                azonositas: "Aszkorbinsav",
                reakcio: "redox-reakci√≥",
                reagens: "dikl√≥rfenol-indofenol",
                eszleles: "feh√©rkiolt√≥ folt a VRK-n"
            }
        ];

        function startTabla(jatekTipus) {
            document.getElementById("tablaSubMenu").style.display = "none";
            document.getElementById("tabla-container").style.display = "block";
            document.getElementById("tabla-cim").innerText = jatekTipus;
    
            if(jatekTipus === "√Åltal√°nos fitok√©mia") {
                let tablaHTML = `
                    <table border="1" style="margin: 0 auto; width: 80%;">
                        <thead>
                            <tr>
                                <th>Azonos√≠t√°si reakci√≥</th>
                                <th>Reagens</th>
                                <th>√âszlel√©s</th>
                            </tr>
                        </thead>
                        <tbody>`;
        
        // V√©letlenszer≈± sorrend √©s kit√∂lt√©s
                const shuffled = [...fitokemiaTablazat].sort(() => 0.5 - Math.random());
        
                shuffled.forEach((sor, index) => {
                    const randomCol = Math.floor(Math.random() * 3); // 0-2 k√∂z√∂tt
                    const options = fitokemiaTablazat.map(x => 
                        randomCol === 0 ? x.azonositas : 
                        randomCol === 1 ? x.reagens : 
                        x.eszleles
                    ).filter((v, i, a) => a.indexOf(v) === i); // Egyediek
            
                    tablaHTML += `<tr>`;
            
                    for(let col = 0; col < 3; col++) {
                        if(col === randomCol) {
                            // Megadott √©rt√©k
                            const value = randomCol === 0 ? sor.azonositas : 
                                 randomCol === 1 ? sor.reagens : 
                                 sor.eszleles;
                            tablaHTML += `<td style="background-color:#f0f0f0">${value}</td>`;
                        } else {
                            // Leg√∂rd√ºl≈ë men√º
                            const colName = col === 0 ? "azonositas" : 
                                           col === 1 ? "reagens" : "eszleles";
                            tablaHTML += `
                                <td>
                                    <select id="tabla-${index}-${col}">
                                        <option value="">V√°lassz...</option>
                                        ${options.map(opt => 
                                            `<option value="${opt}">${opt}</option>`
                                        ).join('')}
                                    </select>
                                </td>`;
                        }
                    }
            
                    tablaHTML += `</tr>`;
                });
        
                tablaHTML += `</tbody></table><br>
                    <button onclick="checkTabla()">Ellen≈ërz√©s</button>`;
        
                document.getElementById("tabla-container").innerHTML = tablaHTML;
            }
        }

function checkTabla() {
    let correct = 0;
    const shuffled = [...fitokemiaTablazat];
    
    shuffled.forEach((sor, rowIndex) => {
        for(let col = 0; col < 3; col++) {
            const select = document.getElementById(`tabla-${rowIndex}-${col}`);
            if(select) {
                const selected = select.value;
                const correctValue = col === 0 ? sor.azonositas : 
                                    col === 1 ? sor.reagens : 
                                    sor.eszleles;
                
                if(selected === correctValue) {
                    correct++;
                    select.style.backgroundColor = "#a0ffa0";
                } else if(selected) {
                    select.style.backgroundColor = "#ffa0a0";
                }
            }
        }
    });
    
    alert(`Eredm√©ny: ${correct} helyes v√°lasz a ${shuffled.length * 2} lehet≈ës√©gb≈ël!`);
}	
        const molekulaAdatok = {
            "D-gl√ºk√≥z": { smiles: "OC1OC(CO)C(O)C(O)C1O", csoport: "Sz√©nhidr√°tok", image: "B-D-glukoz.jpg" },
            "D-frukt√≥z": { smiles: "OCC1OC(O)(CO)C(O)C1O", csoport: "Sz√©nhidr√°tok", image: "B-D-fruktoz.jpg" },
            "D-arabin√≥z": { smiles: "OC1C(O)C(O)C(O)OC1", csoport: "Sz√©nhidr√°tok", image: "B-D-arabinoz.jpg" },
            "szachar√≥z": { smiles: "OCC1OC(C(C(C1O)O)O)OC2(CO)C(O)C(O)C(O2)CO", csoport: "Sz√©nhidr√°tok", image: "szacharoz.jpg" },
            "D-ramn√≥z": { smiles: "CC1C(O)C(O)C(O)C(O1)O", csoport: "Sz√©nhidr√°tok", image: "A-D-ramnoz.jpg" },
            "D-xilit": { smiles: "OCC(O)C(O)C(O)CO", csoport: "Sz√©nhidr√°tok", image: "D-xilit.jpg" },
            "palmitinsav": { smiles: "CCCCCCCCCCCCCCCC(O)=O", csoport: "Lipidek", image: "palmitinsav.jpg" },
            "sztearinsav": { smiles: "CCCCCCCCCCCCCCCCC(=O)O", csoport: "Lipidek", image: "sztearinsav.jpg" },
            "olajsav": { smiles: "CCCCCCCCC=CCCCCCCCC(O)=O", csoport: "Lipidek", image: "olajsav.jpg" },
            "linolsav": { smiles: "CCCCCC=CCC=CCCCCCCCC(O)=O", csoport: "Lipidek", image: "linolsav.jpg" },
            "ricinolsav": { smiles: "CCCCCCCCC=CCCCCC(O)CC(=O)O", csoport: "Lipidek", image: "ricinolsav.jpg" },
            "alfa-linol√©nsav": { smiles: "CCC=CCC=CCC=CCCCCCCCC(O)=O", csoport: "Lipidek", image: "A-linolensav.jpg" },
            "gamma-linol√©nsav": { smiles: "CCCCCC=CCC=CCC=CCCCCC(O)=O", csoport: "Lipidek", image: "G-linolensav.jpg" },
            "b√©ta-szitoszterol": { smiles: "OC1CC=2C(C)(CC1)[CH]3[CH](CC=2)[CH]4C(C)(CC3)C(CC4)C(C)CCC(CC)C(C)C", csoport: "Lipidek", image: "B-szitoszterol.jpg" },
            "citromsav": { smiles: "O=C(O)CC(O)(C(=O)O)CC(O)=O", csoport: "N√∂v√©nyi savak", image: "citromsav.jpg" },
            "almasav": { smiles: "O=C(O)CC(O)C(=O)O", csoport: "N√∂v√©nyi savak", image: "almasav.jpg" },
            "bork≈ësav": { smiles: "OC(=O)C(O)C(O)C(=O)O", csoport: "N√∂v√©nyi savak", image: "borkosav.jpg" },
            "aszkorbinsav": { smiles: "O=C1O[CH](C(CO)O)C(O)=C1O", csoport: "N√∂v√©nyi savak", image: "aszkorbinsav.jpg" },
            "sikimisav": { smiles: "O=C(O)C=1CC(O)C(O)C(C=1)O", csoport: "N√∂v√©nyi savak", image: "sikimisav.jpg" }
        };
// F√ºggv√©nyek friss√≠t√©se
	const novenyAdatok = {
    	    "Graminis rhizoma": { magyardrog: "Tarackb√∫za-gy√∂k√©rt√∂rzs", latin: "Agropyrons repens", csalad: "Poaceae", kep: "Graminis_rhizoma.jpg" },
    	    "Lichen islandicus": { magyardrog: "Izlandi zuzm√≥", latin: "Cetraria islandica", csalad: "Parmeliaceae", kep: "Lichen_islandicus.jpg" },
    	    "Acaciae gummi": { magyardrog: "Ak√°ciam√©zga", latin: "Acacia senegal", csalad: "Fabaceae", kep: "Acaciae_gummi.jpg" },
   	    "Althaeae folium": { magyardrog: "Orvosi ziliz lev√©l", latin: "Althaeae officinalis", csalad: "Malvaceae", kep: "Althaeae_folium.jpg" },
    	    "Anisi stellati fructus": { magyardrog: "Csillag√°nizs term√©s", latin: "Illicium verum", csalad: "Schisandraceae", kep: "Anisi_stellati_fructus.jpg" },
    	    "Cucurbitae semen": { magyardrog: "T√∂kmag", latin: "Cucurbita pepo", csalad: "Cucurbitaceae", kep: "Cucurbitae_semen.jpg" },
    	    "Equiseti herba": { magyardrog: "Mezei zsurl√≥ hajt√°s", latin: "Equisetum arvense", csalad: "Equisetaceae", kep: "Equiseti_herba.jpg" },
     	    "Papaveris semen": { magyardrog: "M√°k mag", latin: "Papaver somniferum", csalad: "Papaveraceae", kep: "Papaveris_semen.jpg" },
    	    "Plantaginis ovatae seminis tegumentum": { magyardrog: "√ötif≈± magh√©j", latin: "Plantago ovata", csalad: "Plantaginaceae", kep: "Plantaginis_ovatae_seminis_tegumentum.jpg" },
    	    "Ricini semen": { magyardrog: "Ricinusmag", latin: "Ricinus communis", csalad: "Euphorbiaceae", kep: "Ricini_semen.jpg" },
   	    "Salviae hispanicae semen": { magyardrog: "Chia mag", latin: "Salvia hispanica", csalad: "Lamiaceae", kep: "Salviae_hispanicae_semen.jpg" },
    	    "Sesami semen": { magyardrog: "Szez√°mmag", latin: "Sesamum indicum", csalad: "Pedaliaceae", kep: "Sesami_semen.jpg" },
	    "Tiliae flos": { magyardrog: "H√°rsfa vir√°g", latin: "Tilia cordata", csalad: "Malvaceae", kep: "Tiliae_flos.jpg" },
	    "Tragacantha": { magyardrog: "Tragakanta gumi", latin: "Astragalus gummifer", csalad: "Fabaceae", kep: "Tragacantha.jpg" },
	    "Trigonella foenugraeci semen": { magyardrog: "G√∂r√∂gsz√©na mag", latin: "Trigonella foenum-graecum", csalad: "Fabaceae", kep: "Trigonella_foenugraeci_semen.jpg" },
	    "Althaeae radix": { magyardrog: "Orvosi ziliz gy√∂k√©r", latin: "Althaeae officinalis", csalad: "Malvaceae", kep: "Althaeae_radix.jpg" },
	    "Malvae folium": { magyardrog: "M√°lyva lev√©l", latin: "Malva sylvestris", csalad: "Malvaceae", kep: "Malvae_folium.jpg" },
	    "Plantaginis lanceolatae folium": { magyardrog: "L√°ndzs√°s √∫tif≈± lev√©l", latin: "Plantago lanceolata", csalad: "Plantaginaceae", kep: "Plantaginis_lanceolatae_folium.jpg" },
	    "Psylli semen": { magyardrog: "Bolhamag", latin: "Plantago psyllium", csalad: "Plantaginaceae", kep: "Psylli_semen.jpg" },
	    "Pulmonariae folium": { magyardrog: "T√ºd≈ëf≈± lev√©l", latin: "Pulmonaria officinalis", csalad: "Boraginaceae", kep: "Pulmonariae_folium.jpg" },
	    "Helianthi annui semen": { magyardrog: "Napraforg√≥mag", latin: "Helianthus annuus", csalad: "Asteraceae", kep: "Helianthi_annui_semen.jpg" },
	    "Hibisci sabdariffae flos": { magyardrog: "Hibiszkusz vir√°g", latin: "Hibiscus sabdariffa", csalad: "Malvaceae", kep: "Hibisci_sabdariffae_flos.jpg" },
	    "Lini semen": { magyardrog: "Lenmag", latin: "Linum usitatissimum", csalad: "Linaceae", kep: "Lini_semen.jpg" },
	    "Malvae sylvestris flos": { magyardrog: "Erdei m√°lyva vir√°g", latin: "Malva sylvestris", csalad: "Malvaceae", kep: "Malvae_sylvestris_flos.jpg" },
 	    "Rosae pseudo-fructus": { magyardrog: "Csipkebogy√≥ √°lterm√©s", latin: "Rosa canina", csalad: "Rosaceae", kep: "Rosae_pseudo-fructus.jpg" },
	    "Taraxaci radix": { magyardrog: "Gyermekl√°ncf≈± gy√∂k√©r", latin: "Taraxacum officinale", csalad: "Asteraceae", kep: "Taraxaci_radix.jpg" },
	    "Verbasci flos": { magyardrog: "√ñk√∂rfarkk√≥r√≥ vir√°g", latin: "Verbascum thapsus", csalad: "Scrophulariaceae", kep: "Verbasci_flos.jpg" }
	};
	// Adatstrukt√∫ra friss√≠t√©se
const mikroKepek = [
    "Ca-oxal√°t_rozetta__Althaeae_radix_pulvis.jpg",
    "Ca-oxal√°t_rozetta__Malvae_sylvestris_flos.jpg",
    "Ca-oxal√°t_rozetta__Rosae_pseudo-fructus.jpg",  
    "Ca-oxal√°t_rozetta__Tiliae_flos.jpg", 
    "Cs√©szelev√©l__Tiliae_flos.jpg",
    "Csillagsz≈ër__Althaeae_folium_pulvis.jpg",
    "Csillagsz≈ër__Malvae_sylvestris_flos.jpg", 
    "Csillagsz≈ër__Tiliae_flos.jpg",  
    "Egysejt≈±_fed≈ësz≈ër__Verbasci_flos.jpg", 
    "Egysejt≈±_fed≈ësz≈ër__Malvae_sylvestris_flos.jpg",
    "Emeletesen_el√°gaz√≥_fed≈ësz≈ër__Verbasci_flos.jpg",  
    "Endospermium__Lini_semen_pulvis.jpg",
    "Hull√°mos_alak√∫_sz≈ër__Malvae_sylvestris_flos.jpg", 
    "Kem√©ny√≠t≈ëszemcs√©k__Althaeae_radix_pulvis.jpg", 
    "Lipidcseppek__Lini_semen_pulvis.jpg", 
    "Mezofillum__Malvae_sylvestris_flos.jpg",
    "Ny√°lka__Althaeae_radix_pulvis.jpg",
    "Ny√°lkaepidermisz__Lini_semen_pulvis.jpg",
    "Pigmentsejtek__Lini_semen_pulvis.jpg",
    "Pollenszem__Althaeae_folium_pulvis.jpg",
    "Pollenszem__Malvae_sylvestris_flos.jpg",
    "Portok__Verbasci_flos.jpg",
    "Rost__Althaeae_radix_pulvis.jpg",
    "Sertesz≈ër__Rosae_pseudo-fructus.jpg",
    "Szklereida_sejtek__Rosae_pseudo-fructus.jpg",
    "Trachea__Althaeae_radix_pulvis.jpg",
    "Zs√≠ros_olajcseppek_karotinoidokkal__Rosae_pseudo-fructus.jpg"
];

const mikroAdatok = {};
const mikroFeatureList = new Set();
const mikroDrogList = new Set();


mikroKepek.forEach(kep => {
    const [featureRaw, drogFile] = kep.split("__");
    
    // Feature n√©v form√°z√°sa
    const feature = featureRaw.replace(/_/g, " ");
    
    // Drog n√©v form√°z√°sa
    const cleanDrog = drogFile
        .replace(/_pulvis/g, "")
        .replace(/.jpg/g, "")    
        .replace(/_/g, " ");    

    if (!mikroAdatok[cleanDrog]) mikroAdatok[cleanDrog] = [];
    mikroAdatok[cleanDrog].push({ feature, kep });
    
    mikroFeatureList.add(feature);
    mikroDrogList.add(cleanDrog);
});
	    
// J√°t√©k ind√≠t√°sa
function startMikroszkopikusJatek() {
    document.getElementById("novenyfelismeresSubMenu").style.display = "none";
    document.getElementById("mikroszkopikus-container").style.display = "block";
    
    // V√©letlenszer≈± drog kiv√°laszt√°sa
    const drogok = Object.keys(mikroAdatok);
    currentMikroDrog = drogok[Math.floor(Math.random() * drogok.length)];
    
    // K√©pek megjelen√≠t√©se
    const kepekDiv = document.getElementById("mikro-kepek");
    kepekDiv.innerHTML = mikroAdatok[currentMikroDrog]
        .map(kep => `
            <div class="kep-es-legordulo">
                <img src="DROG1ZH1MIKROTESZT/${kep.kep}" style="max-width: 200px; margin: 10px;">
                <select class="mikro-feature-select">
                    <option value="">V√°lassz k√©pletet...</option>
                    ${Array.from(mikroFeatureList).map(f => `<option>${f}</option>`).join("")}
                </select>
            </div>
        `).join("");

    // Drog dropdown felt√∂lt√©se
    const drogSelect = document.getElementById("mikro-drog-select");
    drogSelect.innerHTML = `
        <option value="">V√°lassz drogot...</option>
        ${Array.from(mikroDrogList).map(d => `<option>${d}</option>`).join("")}
    `;
}

// Ellen≈ërz√©s logika jav√≠tva
function checkMikro() {
    const valaszSelects = document.querySelectorAll(".mikro-feature-select");
    const drogValasz = document.getElementById("mikro-drog-select").value;
    const helyesValaszok = mikroAdatok[currentMikroDrog].map(k => k.feature);

    let eredmeny = "<strong>Eredm√©nyek:</strong><br>";
    
    // K√©pek ellen≈ërz√©se
    valaszSelects.forEach((select, index) => {
        const valasz = select.value;
        const helyes = helyesValaszok[index];
        const isCorrect = valasz === helyes;
        
        eredmeny += `K√©p ${index+1}: ${isCorrect ? "‚úîÔ∏è" : `‚ùå (helyes: ${helyes})`}<br>`;
    });

    // Drog n√©v ellen≈ërz√©se
    eredmeny += `<br>Drog v√°lasz: ${drogValasz === currentMikroDrog ? "‚úîÔ∏è" : `‚ùå (helyes: ${currentMikroDrog})`}`;

    document.getElementById("mikro-eredmeny").innerHTML = eredmeny;
}

	

function showSubMenu(type) {
    // Minden elem elrejt√©se
    const availableMenus = ['novenyfelismeres', 'kepletek', 'tabla'];
    
    if (!availableMenus.includes(type)) {
        console.log("Ez a men√ºpont ideiglenesen nem el√©rhet≈ë");
        return;
    }
    document.getElementById("mainMenu").style.display = "none";
    document.getElementById("kepletekSubMenu").style.display = "none";
    document.getElementById("novenyfelismeresSubMenu").style.display = "none";
    document.getElementById("szamolasSubMenu").style.display = "none";
    document.getElementById("tablaSubMenu").style.display = "none";
    document.getElementById("sketchem-container").style.display = "none";
    document.getElementById("kepfelismeres-container").style.display = "none";
    document.getElementById("szamolas-container").style.display = "none"; 
    document.getElementById("tabla-container").style.display = "none";
    document.getElementById("makroszkopikus-container").style.display = "none"
	
    document.getElementById(type + "SubMenu").style.display = "block";
}


function startFormulaRecognition() {
    document.getElementById("kepletekSubMenu").style.display = "none";
    document.getElementById("kepfelismeres-container").style.display = "block";
    newMoleculeRecognition();
}

// √öj f√ºggv√©nyek a k√©pfelismer√©shez
function newMoleculeRecognition() {
    const moleculeNames = Object.keys(molekulaAdatok);
    currentMolecule = moleculeNames[Math.floor(Math.random() * moleculeNames.length)];
    document.getElementById("molekula-kep").src = "DROG1ZHMOL/" + molekulaAdatok[currentMolecule].image;
}

function checkName() {
    const answer = document.getElementById("name-input").value.trim();
    const result = (answer.toLowerCase() === currentMolecule.toLowerCase()) 
        ? "‚úîÔ∏è Helyes" 
        : `‚ùå Helytelen (helyes v√°lasz: ${currentMolecule})`;
    document.getElementById("name-output").innerHTML = result;
}

function retryRecognition() {
    document.getElementById("name-input").value = "";
    document.getElementById("name-output").innerHTML = "";
}





function ujMikroJatek() {
    startMikroszkopikusJatek();
    document.getElementById("mikro-eredmeny").innerHTML = "";
}
// Makroszk√≥pikus j√°t√©k ind√≠t√°sa
function startMakroszkopikusJatek() {
    document.getElementById("novenyfelismeresSubMenu").style.display = "none";
    document.getElementById("makroszkopikus-container").style.display = "block";
    ujNoveny();
}

// √öj n√∂v√©ny bet√∂lt√©se
function ujNoveny() {
    const novenyNevek = Object.keys(novenyAdatok);
    aktualisNoveny = novenyNevek[Math.floor(Math.random() * novenyNevek.length)];
    document.getElementById("noveny-kep").src = "DROGZH1JOTESZT/" + novenyAdatok[aktualisNoveny].kep;
    document.getElementById("magyar-drog").value = "";
    document.getElementById("latin-drog").value = "";
    document.getElementById("latin-noveny").value = "";
    document.getElementById("csalad-noveny").value = "";
    document.getElementById("noveny-eredmeny").innerHTML = "";
}

// Ellen≈ërz√©s
function checkNoveny() {
    const elvart = novenyAdatok[aktualisNoveny];
    const valaszok = {
        magyar: document.getElementById("magyar-drog").value.trim(),
        latinDrog: document.getElementById("latin-drog").value.trim(),
        latin: document.getElementById("latin-noveny").value.trim(),
        csalad: document.getElementById("csalad-noveny").value.trim()
    };

    let eredmeny = "<strong>Eredm√©nyek:</strong><br>";
    
    function checkField(userAnswer, correctAnswer, fieldName) {
        const isCorrect = userAnswer.toLowerCase() === correctAnswer.toLowerCase();
        return `${fieldName}: ${isCorrect ? "‚úîÔ∏è" : `‚ùå (helyes: ${correctAnswer})`}<br>`;
    }

    eredmeny += checkField(valaszok.magyar, elvart.magyardrog, "Magyar n√©v");
    eredmeny += checkField(valaszok.latinDrog, aktualisNoveny, "Drog latin neve");
    eredmeny += checkField(valaszok.latin, elvart.latin, "Latin n√©v");
    eredmeny += checkField(valaszok.csalad, elvart.csalad, "Csal√°d");

    document.getElementById("noveny-eredmeny").innerHTML = eredmeny;
}
        let currentMolecule = "";
        let aktualisNoveny = "";
	let currentMikroDrog = "";
        

     
    	function goBack() {
    // Minden elem elrejt√©se
    	    document.getElementById("mainMenu").style.display = "block";
            document.getElementById("kepletekSubMenu").style.display = "none";
            document.getElementById("novenyfelismeresSubMenu").style.display = "none";
	    document.getElementById("szamolasSubMenu").style.display = "none"; // ‚¨ÖÔ∏è Hi√°nyzott
    	    document.getElementById("tablaSubMenu").style.display = "none";
            document.getElementById("sketchem-container").style.display = "none";
            document.getElementById("kepfelismeres-container").style.display = "none";
	    document.getElementById("szamolas-container").style.display = "none";
    	    document.getElementById("tabla-container").style.display = "none";
	    document.getElementById("fitokemia_altalanos-container").style.display = "none";
   	    document.getElementById("fitokemia-container").style.display = "none";
   	    document.getElementById("fitoanalitika-container").style.display = "none";
	    document.getElementById("makroszkopikus-container").style.display = "none";
	    document.getElementById("mikroszkopikus-container").style.display = "none";
	}
        
        function startFormulaDrawing() {
            document.getElementById("kepletekSubMenu").style.display = "none";
            document.getElementById("sketchem-container").style.display = "block";
            newMolecule();  // √∫j molekula kiv√°laszt√°sa
        }

        function openSketChem() {
            window.open("https://itayyaakov.github.io/SketChem/");
        }

        function exportSMILES() {
            const smilesCode = document.getElementById("smiles-input").value.trim();
            const selectedCsoport = document.getElementById("csoport-select").value;

            if (smilesCode && selectedCsoport) {
                const molekula = molekulaAdatok[currentMolecule];
                const isSmilesCorrect = smilesCode === molekula.smiles;
                const isCsoportCorrect = selectedCsoport === molekula.csoport;

                let resultText = `SMILES: ${isSmilesCorrect ? "‚úîÔ∏è Helyes" : "‚ùå Helytelen"}<br>`;
                resultText += `Csoport: ${isCsoportCorrect ? "‚úîÔ∏è Helyes" : "‚ùå Helytelen"}`;

                document.getElementById("smiles-output").innerHTML = resultText;
            } else {
                alert("T√∂ltse ki az √∂sszes mez≈ët!");
            }
        }

        function newMolecule() {
            const moleculeNames = Object.keys(molekulaAdatok);
            currentMolecule = moleculeNames[Math.floor(Math.random() * moleculeNames.length)];
            document.getElementById("molekula-name").innerText = currentMolecule;
        }

        function retry() {
            document.getElementById("smiles-input").value = "";
            document.getElementById("smiles-output").innerHTML = "";
        }
	    // Sz√°mol√°si feladatok ind√≠t√°sa
	    
function startSzamolas(jatekTipus) {
    document.getElementById("szamolasSubMenu").style.display = "none";
    document.getElementById("szamolas-container").style.display = "block";
    document.getElementById("szamolas-cim").innerText = jatekTipus;
}

// T√°bl√°zatkit√∂lt√©s ind√≠t√°sa
function startTabla(jatekTipus) {
    document.getElementById("tablaSubMenu").style.display = "none";
    document.getElementById("tabla-container").style.display = "block";
    document.getElementById("tabla-cim").innerText = jatekTipus;
}
    </script>
</body>
</html>
